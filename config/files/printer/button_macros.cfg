[gcode_macro TOOLHEAD_ACCESS]
description: Move toolhead forward for easy access, e.g. filament change.
gcode:
    SAVE_GCODE_STATE NAME=STATE_TOOLHEAD_MOVE
    G90
    G0 X125 Y10 Z80 F4000
    RESTORE_GCODE_STATE NAME=STATE_TOOLHEAD_MOVE

[gcode_macro TOOLHEAD_CENTER]
description: Move toolhead to the center, because it looks cool.
gcode:
    SAVE_GCODE_STATE NAME=STATE_TOOLHEAD_MOVE
    G90
    G0 X125 Y125 Z80 F4000
    RESTORE_GCODE_STATE NAME=STATE_TOOLHEAD_MOVE

[gcode_macro TOOLHEAD_BACK]
description: Move toolhead to the back, out of the way
gcode:
    SAVE_GCODE_STATE NAME=STATE_TOOLHEAD_MOVE
    G90
    G0 X125 Y250 Z80 F4000
    RESTORE_GCODE_STATE NAME=STATE_TOOLHEAD_MOVE

[gcode_macro LIGHT_WHITE]
description: Part illumination: white
gcode:
    SET_LED LED=stealthburner RED=0 GREEN=0 BLUE=0 WHITE=1 INDEX=2 TRANSMIT=0
    SET_LED LED=stealthburner RED=0 GREEN=0 BLUE=0 WHITE=1 INDEX=3

[gcode_macro LIGHT_VAPORWAVE]
description: Part illumination: red/blue
gcode:
    SET_LED LED=stealthburner RED=1 GREEN=0 BLUE=0 WHITE=0 INDEX=2 TRANSMIT=0
    SET_LED LED=stealthburner RED=0 GREEN=0 BLUE=1 WHITE=0 INDEX=3

[gcode_macro REMOVE_FILAMENT_ABS]
description: Heat extruder and remove filament by retraction.
gcode:
    SAVE_GCODE_STATE NAME=REMOVE_FILAMENT_ABS
    M109 S260
    M83 ; Relative extruder
    G1 E-75 F300 ; F300 = 5mm/s. (TODO: 75mm extrusion is a bit too much, tweak)
    RESTORE_GCODE_STATE NAME=REMOVE_FILAMENT_ABS

[gcode_macro LOAD_FILAMENT_ABS]
description: Heat extruder and load filament by extrusion.
gcode:
    SAVE_GCODE_STATE NAME=LOAD_FILAMENT_ABS
    M109 S260
    M83 ; Relative extruder
    G1 E75 F300 ; F300 = 5mm/s. (TODO: 75mm extrusion is a bit too much, tweak)
    RESTORE_GCODE_STATE NAME=LOAD_FILAMENT_ABS

[gcode_macro RANDOM_COLORS]
description: Random colors for the Stealthburner LEDs
gcode:
    {% for i in range(1,3+1) %}
        {% set r = (range(0,100+1) | random) / 100 %}
        {% set g = (range(0,100+1) | random) / 100%}
        {% set b = (range(0,100+1) | random) / 100%}
        SET_LED LED=stealthburner RED={r} GREEN={g} BLUE={b} WHITE=0 INDEX={i}
    {% endfor %}
